var numeric=function(){};"undefined"!=typeof global&&(global.numeric=numeric),numeric.version="1.2.6",numeric._myIndexOf=function(n){var r,e=this.length;for(r=0;r<e;++r)if(this[r]===n)return r;return-1},numeric.myIndexOf=Array.prototype.indexOf?Array.prototype.indexOf:numeric._myIndexOf,numeric.Function=Function,numeric.precision=4,numeric.largeArray=50,numeric._dim=function(n){for(var r=[];"object"==typeof n;)r.push(n.length),n=n[0];return r},numeric.dim=function(n){var r;return"object"==typeof n?"object"==typeof(r=n[0])?"object"==typeof r[0]?numeric._dim(n):[n.length,r.length]:[n.length]:[]},numeric.mapreduce=function(n,r){return Function("x","accum","_s","_k",'if(typeof accum === "undefined") accum = '+r+';\nif(typeof x === "number") { var xi = x; '+n+'; return accum; }\nif(typeof _s === "undefined") _s = numeric.dim(x);\nif(typeof _k === "undefined") _k = 0;\nvar _n = _s[_k];\nvar i,xi;\nif(_k < _s.length-1) {\n    for(i=_n-1;i>=0;i--) {\n        accum = arguments.callee(x[i],accum,_s,_k+1);\n    }    return accum;\n}\nfor(i=_n-1;i>=1;i-=2) { \n    xi = x[i];\n    '+n+";\n    xi = x[i-1];\n    "+n+";\n}\nif(i === 0) {\n    xi = x[i];\n    "+n+"\n}\nreturn accum;")},numeric.mapreduce2=function(n,r){return Function("x","var n = x.length;\nvar i,xi;\n"+r+";\nfor(i=n-1;i!==-1;--i) { \n    xi = x[i];\n    "+n+";\n}\nreturn accum;")},numeric.dotMMsmall=function(n,r){var e,i,u,t,c,m,o,a,f,s,x;for(t=n.length,c=r.length,m=r[0].length,o=Array(t),e=t-1;e>=0;e--){for(a=Array(m),f=n[e],u=m-1;u>=0;u--){for(s=f[c-1]*r[c-1][u],i=c-2;i>=1;i-=2)x=i-1,s+=f[i]*r[i][u]+f[x]*r[x][u];0===i&&(s+=f[0]*r[0][u]),a[u]=s}o[e]=a}return o},numeric._getCol=function(n,r,e){var i;for(i=n.length-1;i>0;--i)e[i]=n[i][r],e[--i]=n[i][r];0===i&&(e[0]=n[0][r])},numeric.dotMMbig=function(n,r){var e,i,u,t=numeric._getCol,c=r.length,m=Array(c),o=n.length,a=r[0].length,f=new Array(o),s=numeric.dotVV;for(--c,i=--o;-1!==i;--i)f[i]=Array(a);for(i=--a;-1!==i;--i)for(t(r,i,m),u=o;-1!==u;--u)0,e=n[u],f[u][i]=s(e,m);return f},numeric.dotMV=function(n,r){var e,i=n.length,u=(r.length,Array(i)),t=numeric.dotVV;for(e=i-1;e>=0;e--)u[e]=t(n[e],r);return u},numeric.dotVM=function(n,r){var e,i,u,t,c,m,o;for(u=n.length,t=r[0].length,c=Array(t),i=t-1;i>=0;i--){for(m=n[u-1]*r[u-1][i],e=u-2;e>=1;e-=2)o=e-1,m+=n[e]*r[e][i]+n[o]*r[o][i];0===e&&(m+=n[0]*r[0][i]),c[i]=m}return c},numeric.dotVV=function(n,r){var e,i,u=n.length,t=n[u-1]*r[u-1];for(e=u-2;e>=1;e-=2)i=e-1,t+=n[e]*r[e]+n[i]*r[i];return 0===e&&(t+=n[0]*r[0]),t},numeric.dot=function(n,r){var e=numeric.dim;switch(1e3*e(n).length+e(r).length){case 2002:return r.length<10?numeric.dotMMsmall(n,r):numeric.dotMMbig(n,r);case 2001:return numeric.dotMV(n,r);case 1002:return numeric.dotVM(n,r);case 1001:return numeric.dotVV(n,r);case 1e3:return numeric.mulVS(n,r);case 1:return numeric.mulSV(n,r);case 0:return n*r;default:throw new Error("numeric.dot only works on vectors and matrices")}},numeric.pointwise2=function(n,r,e){void 0===e&&(e="");var i,u,t=[],c=/\[i\]$/,m="",o=!1;for(i=0;i<n.length;i++)c.test(n[i])?m=u=n[i].substring(0,n[i].length-3):u=n[i],"ret"===u&&(o=!0),t.push(u);return t[n.length]="var _n = "+m+".length;\nvar i"+(o?"":", ret = Array(_n)")+";\n"+e+"\nfor(i=_n-1;i!==-1;--i) {\n"+r+"\n}\nreturn ret;",Function.apply(null,t)},numeric._biforeach2=function n(r,e,i,u,t){if(u===i.length-1)return t(r,e);var c,m=i[u],o=Array(m);for(c=m-1;c>=0;--c)o[c]=n("object"==typeof r?r[c]:r,"object"==typeof e?e[c]:e,i,u+1,t);return o},numeric._foreach2=function n(r,e,i,u){if(i===e.length-1)return u(r);var t,c=e[i],m=Array(c);for(t=c-1;t>=0;t--)m[t]=n(r[t],e,i+1,u);return m},numeric.ops2={add:"+",sub:"-",mul:"*",div:"/",mod:"%",and:"&&",or:"||",eq:"===",neq:"!==",lt:"<",gt:">",leq:"<=",geq:">=",band:"&",bor:"|",bxor:"^",lshift:"<<",rshift:">>",rrshift:">>>"},numeric.opseq={addeq:"+=",subeq:"-=",muleq:"*=",diveq:"/=",modeq:"%=",lshifteq:"<<=",rshifteq:">>=",rrshifteq:">>>=",bandeq:"&=",boreq:"|=",bxoreq:"^="},numeric.mathfuns=["abs","acos","asin","atan","ceil","cos","exp","floor","log","round","sin","sqrt","tan","isNaN","isFinite"],numeric.mathfuns2=["atan2","pow","max","min"],numeric.ops1={neg:"-",not:"!",bnot:"~",clone:""},numeric.mapreducers={any:["if(xi) return true;","var accum = false;"],all:["if(!xi) return false;","var accum = true;"],sum:["accum += xi;","var accum = 0;"],prod:["accum *= xi;","var accum = 1;"],norm2Squared:["accum += xi*xi;","var accum = 0;"],norminf:["accum = max(accum,abs(xi));","var accum = 0, max = Math.max, abs = Math.abs;"],norm1:["accum += abs(xi)","var accum = 0, abs = Math.abs;"],sup:["accum = max(accum,xi);","var accum = -Infinity, max = Math.max;"],inf:["accum = min(accum,xi);","var accum = Infinity, min = Math.min;"]},function(){var n,r;for(n=0;n<numeric.mathfuns2.length;++n)r=numeric.mathfuns2[n],numeric.ops2[r]=r;for(n in numeric.ops2)if(numeric.ops2.hasOwnProperty(n)){r=numeric.ops2[n];var e,i,u="";-1!==numeric.myIndexOf.call(numeric.mathfuns2,n)?(u="var "+r+" = Math."+r+";\n",e=function(n,e,i){return n+" = "+r+"("+e+","+i+")"},i=function(n,e){return n+" = "+r+"("+n+","+e+")"}):(e=function(n,e,i){return n+" = "+e+" "+r+" "+i},i=numeric.opseq.hasOwnProperty(n+"eq")?function(n,e){return n+" "+r+"= "+e}:function(n,e){return n+" = "+n+" "+r+" "+e}),numeric[n+"VV"]=numeric.pointwise2(["x[i]","y[i]"],e("ret[i]","x[i]","y[i]"),u),numeric[n+"SV"]=numeric.pointwise2(["x","y[i]"],e("ret[i]","x","y[i]"),u),numeric[n+"VS"]=numeric.pointwise2(["x[i]","y"],e("ret[i]","x[i]","y"),u),numeric[n]=Function("var n = arguments.length, i, x = arguments[0], y;\nvar VV = numeric."+n+"VV, VS = numeric."+n+"VS, SV = numeric."+n+'SV;\nvar dim = numeric.dim;\nfor(i=1;i!==n;++i) { \n  y = arguments[i];\n  if(typeof x === "object") {\n      if(typeof y === "object") x = numeric._biforeach2(x,y,dim(x),0,VV);\n      else x = numeric._biforeach2(x,y,dim(x),0,VS);\n  } else if(typeof y === "object") x = numeric._biforeach2(x,y,dim(y),0,SV);\n  else '+i("x","y")+"\n}\nreturn x;\n"),numeric[r]=numeric[n],numeric[n+"eqV"]=numeric.pointwise2(["ret[i]","x[i]"],i("ret[i]","x[i]"),u),numeric[n+"eqS"]=numeric.pointwise2(["ret[i]","x"],i("ret[i]","x"),u),numeric[n+"eq"]=Function("var n = arguments.length, i, x = arguments[0], y;\nvar V = numeric."+n+"eqV, S = numeric."+n+'eqS\nvar s = numeric.dim(x);\nfor(i=1;i!==n;++i) { \n  y = arguments[i];\n  if(typeof y === "object") numeric._biforeach(x,y,s,0,V);\n  else numeric._biforeach(x,y,s,0,S);\n}\nreturn x;\n')}for(n=0;n<numeric.mathfuns2.length;++n)r=numeric.mathfuns2[n],delete numeric.ops2[r];for(n=0;n<numeric.mathfuns.length;++n)r=numeric.mathfuns[n],numeric.ops1[r]=r;for(n in numeric.ops1)numeric.ops1.hasOwnProperty(n)&&(u="",r=numeric.ops1[n],-1!==numeric.myIndexOf.call(numeric.mathfuns,n)&&Math.hasOwnProperty(r)&&(u="var "+r+" = Math."+r+";\n"),numeric[n+"eqV"]=numeric.pointwise2(["ret[i]"],"ret[i] = "+r+"(ret[i]);",u),numeric[n+"eq"]=Function("x",'if(typeof x !== "object") return '+r+"x\nvar i;\nvar V = numeric."+n+"eqV;\nvar s = numeric.dim(x);\nnumeric._foreach(x,s,0,V);\nreturn x;\n"),numeric[n+"V"]=numeric.pointwise2(["x[i]"],"ret[i] = "+r+"(x[i]);",u),numeric[n]=Function("x",'if(typeof x !== "object") return '+r+"(x)\nvar i;\nvar V = numeric."+n+"V;\nvar s = numeric.dim(x);\nreturn numeric._foreach2(x,s,0,V);\n"));for(n=0;n<numeric.mathfuns.length;++n)r=numeric.mathfuns[n],delete numeric.ops1[r];for(n in numeric.mapreducers)numeric.mapreducers.hasOwnProperty(n)&&(r=numeric.mapreducers[n],numeric[n+"V"]=numeric.mapreduce2(r[0],r[1]),numeric[n]=Function("x","s","k",r[1]+'if(typeof x !== "object") {    xi = x;\n'+r[0]+';\n    return accum;\n}if(typeof s === "undefined") s = numeric.dim(x);\nif(typeof k === "undefined") k = 0;\nif(k === s.length-1) return numeric.'+n+"V(x);\nvar xi;\nvar n = x.length, i;\nfor(i=n-1;i!==-1;--i) {\n   xi = arguments.callee(x[i]);\n"+r[0]+";\n}\nreturn accum;\n"))}(),numeric.norm2=function(n){return Math.sqrt(numeric.norm2Squared(n))},numeric.transform_point=function(n,r){var e,i,u,t,c,m,o,a,f,s,x,l;for(console.assert(n.length===(l=r.length)&&4===l),e=[],c=f=0;f<4;c=++f)e.push([n[c].x,n[c].y,1,0,0,0,-n[c].x*r[c].x,-n[c].y*r[c].x]),e.push([0,0,0,n[c].x,n[c].y,1,-n[c].x*r[c].y,-n[c].y*r[c].y]);for(u=[],c=s=0;s<4;c=++s)u.push(r[c].x),u.push(r[c].y);for(i=[[(t=numeric.solve(e,u))[0],t[1],0,t[2]],[t[3],t[4],0,t[5]],[0,0,1,0],[t[6],t[7],0,1]],c=x=0;x<4;c=++x)m=(o=numeric.dot(i,[n[c].x,n[c].y,0,1]))[3],a=numeric.dot(m,[r[c].x,r[c].y,0,1]),console.assert(numeric.norm2(numeric.sub(o,a))<1e-9,"Not equal:",o,a);return i},numeric.solve=function(n,r,e){return numeric.LUsolve(numeric.LU(n,e),r)},numeric.LUsolve=function(n,r){var e,i,u,t,c,m=n.LU,o=m.length,a=[],f=n.P;for(e=o-1;-1!==e;--e)a[e]=r[e];for(e=0;e<o;++e)for(u=f[e],f[e]!==e&&(c=a[e],a[e]=a[u],a[u]=c),t=m[e],i=0;i<e;++i)a[e]-=a[i]*t[i];for(e=o-1;e>=0;--e){for(t=m[e],i=e+1;i<o;++i)a[e]-=a[i]*t[i];a[e]/=t[e]}return a},numeric.LU=function(n,r){r=r||!1;var e,i,u,t,c,m,o,a,f,s=Math.abs,x=n.length,l=x-1,h=new Array(x);for(u=0;u<x;++u){for(o=u,f=s((m=n[u])[u]),i=u+1;i<x;++i)f<(t=s(n[i][u]))&&(f=t,o=i);for(h[u]=o,o!=u&&(n[u]=n[o],n[o]=m,m=n[u]),c=m[u],e=u+1;e<x;++e)n[e][u]/=c;for(e=u+1;e<x;++e){for(a=n[e],i=u+1;i<l;++i)a[i]-=a[u]*m[i],a[++i]-=a[u]*m[i];i===l&&(a[i]-=a[u]*m[i])}}return{LU:n,P:h}};